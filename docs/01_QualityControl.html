<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="SarahL." />


<title>Quality Control and Filtering</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RA SingleCellAnalysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00_DataPreparation.html">Data Preparation</a>
    </li>
    <li>
      <a href="01_QualityControl.html">Quality Control</a>
    </li>
    <li>
      <a href="02_DimensionalityReduction.html">Dimensionality Reduction</a>
    </li>
    <li>
      <a href="03_Integration_Batchelor.html">Integration</a>
    </li>
    <li>
      <a href="04_Clustering.html">Clustering</a>
    </li>
    <li>
      <a href="05_CelltypeAnnotation.html">Annotation</a>
    </li>
  </ul>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sarloet/RA_SingleCellAnalysis">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Quality Control and Filtering</h1>
<h3 class="subtitle">01_QualityControl</h3>
<h4 class="author">SarahL.</h4>
<h4 class="date">May 13 2024 13:56:02</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-05-13
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>RA_SingleCellAnalysis/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20240328code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20240328)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20240328code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20240328)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomsarloetRASingleCellAnalysistreeb04fd2c01a477c45c6c67e5fdadf37f5dc70ec65targetblankb04fd2ca">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/tree/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65" target="_blank">b04fd2c</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomsarloetRASingleCellAnalysistreeb04fd2c01a477c45c6c67e5fdadf37f5dc70ec65targetblankb04fd2ca"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/tree/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65" target="_blank">b04fd2c</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    data/cellbender_data_h5/
    Ignored:    output/._Cluster_Marker_Genes.xlsx
    Ignored:    output/00_sce_DataPreparation.rds
    Ignored:    output/01_sce_QualityControl.rds
    Ignored:    output/01_sce_QualityControl_filtered.rds
    Ignored:    output/02_sce_DimensionalityReduction.rds
    Ignored:    output/03_sce_Integration_Batchelor.rds
    Ignored:    output/03_sce_Integration_Harmony.rds
    Ignored:    output/04_sce_Clustering.rds
    Ignored:    output/05_sce_CelltypeAnnotation.rds
    Ignored:    output/06_sce_SC_Endothelial.rds
    Ignored:    output/06_sce_SC_Fibroblast.rds
    Ignored:    output/06_sce_SC_Myeloid.rds
    Ignored:    output/06_sce_SC_Tcell.rds
    Ignored:    output/08_DifferentialAbundance_miloR.rds
    Ignored:    output/Cluster_Marker_Genes.xlsx

Unstaged changes:
    Modified:   analysis/00_DataPreparation.Rmd
    Modified:   analysis/01_QualityControl.Rmd
    Modified:   analysis/04_Clustering.Rmd
    Modified:   analysis/06_SC_Fibroblast.Rmd
    Modified:   analysis/07_DifferentialExpression_EdgeR.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/01_QualityControl.Rmd</code>) and
HTML (<code>docs/01_QualityControl.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/analysis/01_QualityControl.Rmd" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
<td>
fx
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/01_QualityControl.html" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
<td>
fx
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/analysis/01_QualityControl.Rmd" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/01_QualityControl.html" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/analysis/01_QualityControl.Rmd" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/01_QualityControl.html" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="quality-control-and-preprocessing" class="section level1">
<h1>Quality Control and Preprocessing</h1>
<div id="setup" class="section level2">
<h2>Setup</h2>
<div id="standard-packages" class="section level3">
<h3>Standard packages</h3>
<pre class="r"><code>library(here)
source(here(&quot;code&quot;, &quot;standard_libraries.R&quot;))</code></pre>
</div>
<div id="additional-packages" class="section level3">
<h3>Additional Packages</h3>
<pre class="r"><code>#Load Packages
suppressPackageStartupMessages({
library(grid)
})</code></pre>
</div>
<div id="set-parameter" class="section level3">
<h3>Set Parameter</h3>
<pre class="r"><code>set.seed(123)
bpp &lt;- BiocParallel::MulticoreParam(parallel::detectCores()-1, RNGseed=123)
path &lt;- here::here()</code></pre>
</div>
</div>
<div id="load-data" class="section level2">
<h2>Load Data</h2>
<pre class="r"><code>## Load the RA DATASET
sce &lt;- readRDS(file = paste0(path,&#39;/output/00_sce_DataPreparation.rds&#39;))</code></pre>
<div id="explore-dataset-dimensions" class="section level3">
<h3>Explore Dataset Dimensions</h3>
<pre class="r"><code>#Dimensions of count matrix
dim(sce)</code></pre>
<pre><code>[1] 34594 82769</code></pre>
</div>
<div id="histogramm-with-number-of-cells" class="section level3 tabset">
<h3 class="tabset">Histogramm with number of cells</h3>
<p>Show the number of cells detected in each sample or joint location
before filtering</p>
<div id="per-sample" class="section level4">
<h4>Per Sample</h4>
<pre class="r"><code>#Histogramm with number of cells per sample
ggplot(colData(sce), aes(x=Sample)) +
  geom_bar()+ coord_flip()+ ggtitle(&quot;Number of cells per sample&quot;) + 
  theme_bw() + stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.65))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsPerSample-1">
Past versions of PlotCellsPerSample-1.png
</button>
</p>
<div id="fig-PlotCellsPerSample-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>data.frame(as.list(table(colData(sce)$Sample)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["SynBio_028"],"name":[1],"type":["int"],"align":["right"]},{"label":["SynBio_049"],"name":[2],"type":["int"],"align":["right"]},{"label":["SynBio_050"],"name":[3],"type":["int"],"align":["right"]},{"label":["SynBio_074"],"name":[4],"type":["int"],"align":["right"]},{"label":["SynBio_076"],"name":[5],"type":["int"],"align":["right"]},{"label":["SynBio_077a"],"name":[6],"type":["int"],"align":["right"]},{"label":["SynBio_077b"],"name":[7],"type":["int"],"align":["right"]},{"label":["SynBio_081"],"name":[8],"type":["int"],"align":["right"]},{"label":["SynBio_083"],"name":[9],"type":["int"],"align":["right"]},{"label":["SynBio_084"],"name":[10],"type":["int"],"align":["right"]},{"label":["SynBio_087"],"name":[11],"type":["int"],"align":["right"]},{"label":["SynBio_093"],"name":[12],"type":["int"],"align":["right"]},{"label":["SynBio_096"],"name":[13],"type":["int"],"align":["right"]},{"label":["SynBio_098a"],"name":[14],"type":["int"],"align":["right"]},{"label":["SynBio_098b"],"name":[15],"type":["int"],"align":["right"]},{"label":["SynBio_127"],"name":[16],"type":["int"],"align":["right"]},{"label":["SynBio_130"],"name":[17],"type":["int"],"align":["right"]}],"data":[{"1":"3922","2":"667","3":"4977","4":"4104","5":"2491","6":"6224","7":"6129","8":"6301","9":"5106","10":"4810","11":"3358","12":"5727","13":"6729","14":"5177","15":"6097","16":"3806","17":"7144"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="per-joint-location" class="section level4">
<h4>Per Joint Location</h4>
<pre class="r"><code>#Histogramm with number of cells per sample
ggplot(colData(sce), aes(x=Joint.Location))+
  geom_bar(stat = &quot;count&quot;)+ coord_flip()+ ggtitle(&quot;Number of cells per sample&quot;) + 
  theme_bw() +stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.8))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsJoint-1">
Past versions of PlotCellsJoint-1.png
</button>
</p>
<div id="fig-PlotCellsJoint-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>data.frame(as.list(table(colData(sce)$Joint.Location)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Knee"],"name":[1],"type":["int"],"align":["right"]},{"label":["MCP"],"name":[2],"type":["int"],"align":["right"]},{"label":["Wrist"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"27663","2":"23883","3":"31223"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="exclude-samples" class="section level3">
<h3>Exclude Samples</h3>
<pre class="r"><code>#Dimensions of count matrix
#sce &lt;- sce[, !colData(sce)$discard]
sce &lt;- sce[,sce$Sample != &quot;SynBio_049&quot;]
dim(sce)</code></pre>
<pre><code>[1] 34594 82102</code></pre>
</div>
</div>
<div id="filter-cells" class="section level2">
<h2>Filter Cells</h2>
<p>The main goal of quality control is to remove low-quality reads from
the dataset. When a cell has a low number of detected genes, a low count
depth and a high fraction of mitochondrial counts it might have a broken
membrane which can indicate a dying cell.</p>
<p>We filter for: - Low number of counts per barcode (count depth) - Low
number number of genes per barcode - High fraction of counts from
mitochondrial genes per barcode</p>
<pre class="r"><code># Indentify mitochondrial genes
is_mito&lt;- grepl(&quot;(^MT-)|(^mt-)&quot;, rowData(sce)$Symbol)
rowData(sce)$Symbol[is_mito] #Show the MT genes</code></pre>
<pre><code> [1] &quot;MT-ND1&quot;  &quot;MT-ND2&quot;  &quot;MT-CO1&quot;  &quot;MT-CO2&quot;  &quot;MT-ATP8&quot; &quot;MT-ATP6&quot; &quot;MT-CO3&quot; 
 [8] &quot;MT-ND3&quot;  &quot;MT-ND4L&quot; &quot;MT-ND4&quot;  &quot;MT-ND5&quot;  &quot;MT-ND6&quot;  &quot;MT-CYB&quot; </code></pre>
<pre class="r"><code># Indentify HBB genes
is_hbb&lt;- grepl(&quot;(^HBB)|(^hbb)&quot;, rowData(sce)$Symbol)
rowData(sce)$Symbol[is_hbb] #Show the HBB genes</code></pre>
<pre><code>[1] &quot;HBB&quot;</code></pre>
<pre class="r"><code># calculate per-cell quality control (QC) metrics using scater
sce &lt;- addPerCellQC(sce, subsets=list(Mito=is_mito, Hbb=is_hbb))</code></pre>
<div id="fixed-filtering-thresholds" class="section level3">
<h3>Fixed Filtering Thresholds</h3>
<pre class="r"><code>#Some Fixed thresholds
colData(sce)$qc.count_manual &lt;- sce$sum &lt; 750 |sce$sum &gt; 100000 # Cells have at least a count of 400 |sce$sum &gt; 100000
colData(sce)$qc.genexp_manual &lt;- sce$detected &lt; 500 | sce$detected &gt; 10000  # Cells have at least 300 genes expressed 
colData(sce)$qc.mito_manual &lt;- sce$subsets_Mito_percent &gt; 10 #Mitochondrial contamination has to be lower than 15%
colData(sce)$qc.hbb_manual &lt;- sce$subsets_Hbb_percent &gt; 5 #Remove cells expressing HBB (erythrocytes)</code></pre>
<pre class="r"><code>#Some Fixed thresholds
hist(sce$total,breaks = 100,main =&quot;UMI distribution&quot;,xlab =&quot;UMI&quot;)
abline(v = 400, col = &quot;red&quot;)
abline(v = 100000, col = &quot;red&quot;)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/SumHisto-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-SumHisto-1">
Past versions of SumHisto-1.png
</button>
</p>
<div id="fig-SumHisto-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#Some Fixed thresholds
hist(sce$detected,breaks = 100, main =&quot;Detected gene distribution&quot;,xlab =&quot;Detected&quot;)
abline(v = 300, col = &quot;red&quot;)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/DetectedHisto-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-DetectedHisto-1">
Past versions of DetectedHisto-1.png
</button>
</p>
<div id="fig-DetectedHisto-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="adaptive-filtering-thresholds-for-each-batchsample"
class="section level3">
<h3>Adaptive Filtering Thresholds (for each batch/sample)</h3>
<pre class="r"><code># Detect cells with very low number of counts
colData(sce)$qc.count &lt;- isOutlier(sce$sum,nmads=3, log=TRUE, type=&quot;both&quot;,batch =sce$Sample )
data.frame(attr(colData(sce)$qc.count, &quot;thresholds&quot;)) </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SynBio_028"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SynBio_050"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SynBio_074"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SynBio_076"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SynBio_077a"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["SynBio_077b"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["SynBio_081"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["SynBio_083"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["SynBio_084"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["SynBio_087"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["SynBio_093"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["SynBio_096"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["SynBio_098a"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["SynBio_098b"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["SynBio_127"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["SynBio_130"],"name":[16],"type":["dbl"],"align":["right"]}],"data":[{"1":"1910.64","2":"266.4729","3":"502.0912","4":"433.1927","5":"1130.322","6":"1764.154","7":"806.5916","8":"1398.772","9":"1049.949","10":"387.26","11":"681.1673","12":"340.8162","13":"396.6061","14":"1.759563e+01","15":"524.1913","16":"24.22748","_rn_":"lower"},{"1":"82053.86","2":"271070.6908","3":"268646.3216","4":"152806.1239","5":"112827.848","6":"158333.370","7":"271342.3047","8":"96132.322","9":"166378.669","10":"189475.70","11":"117490.8448","12":"285313.1009","13":"129622.0674","14":"1.267205e+06","15":"125721.1145","16":"79289.94852","_rn_":"higher"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Detect cells with very low number of genes
colData(sce)$qc.genexp &lt;- isOutlier(sce$detected,nmads=3, log=TRUE, type=&quot;both&quot;,batch =sce$Sample)
data.frame(attr(colData(sce)$qc.genexp, &quot;thresholds&quot;))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SynBio_028"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SynBio_050"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SynBio_074"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SynBio_076"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SynBio_077a"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["SynBio_077b"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["SynBio_081"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["SynBio_083"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["SynBio_084"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["SynBio_087"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["SynBio_093"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["SynBio_096"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["SynBio_098a"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["SynBio_098b"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["SynBio_127"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["SynBio_130"],"name":[16],"type":["dbl"],"align":["right"]}],"data":[{"1":"1141.421","2":"306.9525","3":"479.4336","4":"447.745","5":"919.6335","6":"1256.451","7":"800.4009","8":"1002.602","9":"897.592","10":"324.374","11":"643.7162","12":"419.1913","13":"360.3054","14":"39.72834","15":"436.5328","16":"31.80393","_rn_":"lower"},{"1":"12326.740","2":"26073.2190","3":"22583.7119","4":"16499.400","5":"12507.4528","6":"13872.906","7":"19900.1284","8":"11106.665","9":"15276.660","10":"22590.739","11":"14527.1527","12":"24611.5432","13":"16537.3070","14":"96696.72082","15":"17198.2476","16":"23498.98156","_rn_":"higher"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Detect cells with high mitochondrial content
colData(sce)$qc.mito &lt;- isOutlier(sce$subsets_Mito_percent,nmads=3, type=&quot;higher&quot;,batch =sce$Sample)
data.frame(attr(colData(sce)$qc.mito, &quot;thresholds&quot;)) </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SynBio_028"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SynBio_050"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SynBio_074"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SynBio_076"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SynBio_077a"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["SynBio_077b"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["SynBio_081"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["SynBio_083"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["SynBio_084"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["SynBio_087"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["SynBio_093"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["SynBio_096"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["SynBio_098a"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["SynBio_098b"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["SynBio_127"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["SynBio_130"],"name":[16],"type":["dbl"],"align":["right"]}],"data":[{"1":"-Inf","2":"-Inf","3":"-Inf","4":"-Inf","5":"-Inf","6":"-Inf","7":"-Inf","8":"-Inf","9":"-Inf","10":"-Inf","11":"-Inf","12":"-Inf","13":"-Inf","14":"-Inf","15":"-Inf","16":"-Inf","_rn_":"lower"},{"1":"12.5285","2":"16.57368","3":"15.28168","4":"13.68089","5":"15.61101","6":"14.63111","7":"10.84631","8":"9.469379","9":"12.56255","10":"9.173393","11":"15.92767","12":"14.13426","13":"16.54378","14":"15.10819","15":"16.6092","16":"8.656053","_rn_":"higher"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Mark all Cells to be Discarted
colData(sce)$discard &lt;- sce$qc.count | sce$qc.count_manual | sce$qc.genexp | sce$qc.genexp_manual | sce$qc.mito | sce$qc.mito_manual | sce$qc.hbb_manual</code></pre>
<pre class="r"><code># Summary of all discarted cells
data.frame(`Library_size` = sum(sce$qc.count | sce$qc.count_manual),
           `Genes_detected` = sum(sce$qc.genexp| sce$qc.genexp_manual),
           `Mitochondrial_percentage` = sum(sce$qc.mito| sce$qc.mito_manual),
           `HBB_expression` = sum(sce$qc.hbb_manual),
           Total_discarded = sum(sce$discard))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Library_size"],"name":[1],"type":["int"],"align":["right"]},{"label":["Genes_detected"],"name":[2],"type":["int"],"align":["right"]},{"label":["Mitochondrial_percentage"],"name":[3],"type":["int"],"align":["right"]},{"label":["HBB_expression"],"name":[4],"type":["int"],"align":["right"]},{"label":["Total_discarded"],"name":[5],"type":["int"],"align":["right"]}],"data":[{"1":"5948","2":"9236","3":"12656","4":"47","5":"19025"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="qc-filtering-plots" class="section level3">
<h3>QC Filtering Plots</h3>
<p>The aim by plotting the proportion of mitochondrial counts against
some of the other QC metrics is to confirm that there are no cells with
both large total counts and large mitochondrial counts, to ensure that
we are not inadvertently removing high-quality cells that happen to be
highly metabolically active (e.g., hepatocytes).</p>
<div id="scatter-plots-per-sample" class="section level4 tabset">
<h4 class="tabset">Scatter Plots Per Sample</h4>
<div id="detected-genes-vs-total-number-of-umis" class="section level5">
<h5>Detected genes vs total number of UMIs</h5>
<pre class="r"><code>colData(sce) %&gt;% 
    as.data.frame() %&gt;% 
    arrange(discard) %&gt;% 
    ggplot(aes(x = sum, y = detected)) +
      geom_point(aes(colour = discard)) + 
      facet_wrap(vars(Sample))+
      labs(title=&quot;Total number of detected genes plotted against total number of UMIs&quot;,
       x=&quot;Total counts&quot;,
       y=&quot;Detected genes&quot;) +
      ggtitle(&quot;Total number of detected genes plotted against total number of UMIs&quot;) + 
      theme(strip.background=element_rect(fill=&quot;white&quot;), panel.background = element_rect(fill = NA),axis.line = element_line(colour = &quot;black&quot;)) </code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots1-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots1-1">
Past versions of QcPlots1-1.png
</button>
</p>
<div id="fig-QcPlots1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="mitochondrial-percentage-vs-total-number-of-umis"
class="section level5">
<h5>Mitochondrial percentage vs total number of UMIs</h5>
<pre class="r"><code>colData(sce) %&gt;% 
    as.data.frame() %&gt;% 
    arrange(discard) %&gt;% 
    ggplot(aes(x = sum, y = subsets_Mito_percent)) +
      geom_point(aes(colour = discard)) + 
      facet_wrap(vars(Sample)) +
      labs(title=&quot;Percentage of mitochondrial UMIs plotted against total number of UMIs&quot;,
       x=&quot;Total counts&quot;,
       y=&quot;Mitochondrial UMIs [%]&quot;) +
      theme(strip.background=element_rect(fill=&quot;white&quot;), panel.background = element_rect(fill = NA),axis.line = element_line(colour = &quot;black&quot;)) </code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots2-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots2-1">
Past versions of QcPlots2-1.png
</button>
</p>
<div id="fig-QcPlots2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="violin-plots-per-sample" class="section level4 tabset">
<h4 class="tabset">Violin Plots Per Sample</h4>
<div id="total-counts" class="section level5">
<h5>Total counts</h5>
<pre class="r"><code>#Plot Total count
plotColData(sce, x=&quot;Sample&quot;, y=&quot;sum&quot;,other_fields=&quot;Sample&quot;,colour_by = &quot;discard&quot;) + 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) + 
    scale_y_log10() + 
    ggtitle(&quot;Total count&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots3-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots3-1">
Past versions of QcPlots3-1.png
</button>
</p>
<div id="fig-QcPlots3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="genes-detected" class="section level5">
<h5>Genes detected</h5>
<pre class="r"><code>#Plot Detected Genes
plotColData(sce, x=&quot;Sample&quot;, y=&quot;detected&quot;, other_fields=&quot;Sample&quot;,colour_by =&quot;discard&quot;)+ 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) + 
    scale_y_log10() + 
    ggtitle(&quot;Detected features&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots4-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots4-1">
Past versions of QcPlots4-1.png
</button>
</p>
<div id="fig-QcPlots4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="mitochondrial-percentage" class="section level5">
<h5>Mitochondrial percentage</h5>
<pre class="r"><code>#Plot Mito percent
plotColData(sce, x=&quot;Sample&quot;, y=&quot;subsets_Mito_percent&quot;, other_fields=&quot;Sample&quot;,colour_by = data.frame(factor(sce$qc.mito | sce$qc.mito_manual,levels=c(FALSE,TRUE)))) + 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) +
    ggtitle(&quot;Mito percent&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1,), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots5-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots5-1">
Past versions of QcPlots5-1.png
</button>
</p>
<div id="fig-QcPlots5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="hbb-percentage" class="section level5">
<h5>HBB percentage</h5>
<pre class="r"><code>#Plot Mito percent
plotColData(sce, x=&quot;Sample&quot;, y=&quot;subsets_Hbb_percent&quot;, other_fields=&quot;Sample&quot;,colour_by = data.frame(factor(sce$qc.hbb_manual,levels=c(FALSE,TRUE)))) + 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) +
    ggtitle(&quot;Mito percent&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1,), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlotshbb-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="cells-to-be-removed-histogramm" class="section level4 tabset">
<h4 class="tabset">Cells to be Removed Histogramm</h4>
<div id="absolute-comparison" class="section level5">
<h5>Absolute comparison</h5>
<pre class="r"><code>#Cells marked to be dropped per samples
# Absolute comparison / by sample
as.data.frame(colData(sce)) %&gt;%
  group_by(Sample, discard) %&gt;%
  summarise(Freq=n()) %&gt;% 
  ggplot(aes(x=Sample, y=Freq, fill=discard, label=Freq)) +
    geom_bar(stat=&quot;identity&quot;, position=&quot;stack&quot;) +
    labs(title=&quot;Cells to be dropped&quot;,
       subtitle=&quot;Labels represent absolute number of cells&quot;,
       x=&quot;&quot;,
       y=&quot;Number of cells&quot;) + 
    geom_text(size=3, position = position_stack(vjust=0.5))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.line = element_line(colour = &quot;black&quot;), panel.background = element_rect(fill = NA)) </code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots6-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots6-1">
Past versions of QcPlots6-1.png
</button>
</p>
<div id="fig-QcPlots6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="relative-comparison" class="section level5">
<h5>Relative comparison</h5>
<pre class="r"><code>#Cells marked to be dropped per samples
# Relative comparison / by sample
as.data.frame(colData(sce)) %&gt;%
  group_by(Sample, discard) %&gt;%
  summarise(Freq=n()) %&gt;% 
  ggplot(aes(x=Sample, y=Freq, fill=discard, label=Freq)) +
    geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;) +
    labs(title=&quot;Cells to be dropped&quot;,
       subtitle=&quot;Labels represent absolute number of cells&quot;,
       x=&quot;&quot;,
       y=&quot;Number of cells&quot;) + 
    geom_text(size=3, position = position_fill(vjust=0.5))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.line = element_line(colour = &quot;black&quot;), panel.background = element_rect(fill = NA)) </code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots7-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots7-1">
Past versions of QcPlots7-1.png
</button>
</p>
<div id="fig-QcPlots7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="apply-filtering" class="section level3">
<h3>Apply filtering</h3>
<pre class="r"><code># Create the filtered sce element
sce.filtered &lt;- sce[, !colData(sce)$discard]

cat(
    &quot;NR of Genes Before Filtering &quot;, dim(sce)[2],
    &quot;\nNR of Genes After Filtering &quot;, dim(sce.filtered)[2],
    &quot;\nNR of Genes Filtered out &quot;, dim(sce)[2] - dim(sce.filtered)[2]
    )</code></pre>
<pre><code>NR of Genes Before Filtering  82102 
NR of Genes After Filtering  63077 
NR of Genes Filtered out  19025</code></pre>
<div id="save-filtered-data" class="section level4">
<h4>Save filtered Data</h4>
<pre class="r"><code>saveRDS(sce.filtered, file =paste0(path,&#39;/output/01_sce_QualityControl_filtered.rds&#39;))</code></pre>
</div>
</div>
</div>
<div id="filter-genes" class="section level2">
<h2>Filter Genes</h2>
<p>Additionally, perform some filtering by prevalence. If a gene is only
expressed in a handful of cells, it is not particularly meaningful as it
still brings down the averages for all other cells it is not expressed
in. For this dataset we choose to keep only genes which are expressed in
10 or more cells. This should be performed after filtering out for low
quality cells.</p>
<pre class="r"><code>#Filter out genes 
dim_before_filtering &lt;- dim(sce.filtered)

#Get only the detected Genes
detected_genes &lt;- rowSums(counts(sce.filtered)&gt; 0)

#Remove Genes not expressed in at least 10 Cells 
sce.filtered &lt;- sce.filtered[detected_genes &gt; 10,]


dim_after_filtering &lt;- dim(sce.filtered)

cat(
    &quot;NR of Genes Before Filtering &quot;, dim_before_filtering[1],
    &quot;\nNR of Genes After Filtering &quot;, dim_after_filtering[1],
    &quot;\nNR of Genes Filtered out &quot;, dim_before_filtering[1] - dim_after_filtering[1]
    )</code></pre>
<pre><code>NR of Genes Before Filtering  34594 
NR of Genes After Filtering  30426 
NR of Genes Filtered out  4168</code></pre>
</div>
<div id="plots-after-filtering" class="section level2">
<h2>Plots after Filtering</h2>
<div id="histogramm-with-number-of-cells-1"
class="section level3 tabset">
<h3 class="tabset">Histogramm with number of cells</h3>
<p>Show the number of cells detected in each sample or joint location
after filtering</p>
<div id="per-sample-1" class="section level4">
<h4>Per Sample</h4>
<pre class="r"><code>#Histogramm with number of cells per sample after filtering
ggplot(as.data.frame(colData(sce.filtered)), aes(x=Sample))+geom_bar()+ coord_flip()+ ggtitle(&quot;Number of cells per sample&quot;) + 
  theme_bw() + stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.65))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsPerSampleAfterFiltering1-1">
Past versions of PlotCellsPerSampleAfterFiltering1-1.png
</button>
</p>
<div id="fig-PlotCellsPerSampleAfterFiltering1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>data.frame(as.list(table(colData(sce.filtered)$Sample)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["SynBio_028"],"name":[1],"type":["int"],"align":["right"]},{"label":["SynBio_050"],"name":[2],"type":["int"],"align":["right"]},{"label":["SynBio_074"],"name":[3],"type":["int"],"align":["right"]},{"label":["SynBio_076"],"name":[4],"type":["int"],"align":["right"]},{"label":["SynBio_077a"],"name":[5],"type":["int"],"align":["right"]},{"label":["SynBio_077b"],"name":[6],"type":["int"],"align":["right"]},{"label":["SynBio_081"],"name":[7],"type":["int"],"align":["right"]},{"label":["SynBio_083"],"name":[8],"type":["int"],"align":["right"]},{"label":["SynBio_084"],"name":[9],"type":["int"],"align":["right"]},{"label":["SynBio_087"],"name":[10],"type":["int"],"align":["right"]},{"label":["SynBio_093"],"name":[11],"type":["int"],"align":["right"]},{"label":["SynBio_096"],"name":[12],"type":["int"],"align":["right"]},{"label":["SynBio_098a"],"name":[13],"type":["int"],"align":["right"]},{"label":["SynBio_098b"],"name":[14],"type":["int"],"align":["right"]},{"label":["SynBio_127"],"name":[15],"type":["int"],"align":["right"]},{"label":["SynBio_130"],"name":[16],"type":["int"],"align":["right"]}],"data":[{"1":"3306","2":"3727","3":"3089","4":"2035","5":"4734","6":"4875","7":"5391","8":"4285","9":"3896","10":"2806","11":"4246","12":"5447","13":"3598","14":"4145","15":"2797","16":"4700"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="per-joint-location-1" class="section level4">
<h4>Per Joint Location</h4>
<pre class="r"><code>#Histogramm with number of cells per sample after filtering
ggplot(as.data.frame(colData(sce.filtered)), aes(x=Joint.Location))+geom_bar()+ coord_flip()+ggtitle(&quot;Number of cells per Joint&quot;) + 
  theme_bw() + stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.8))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsPerJointAfterFiltering2-1">
Past versions of PlotCellsPerJointAfterFiltering2-1.png
</button>
</p>
<div id="fig-PlotCellsPerJointAfterFiltering2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>data.frame(as.list(table(colData(sce.filtered)$Joint.Location)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Knee"],"name":[1],"type":["int"],"align":["right"]},{"label":["MCP"],"name":[2],"type":["int"],"align":["right"]},{"label":["Wrist"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"20822","2":"18238","3":"24017"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div id="plot-top-25-genes-in-the-dataset" class="section level3">
<h3>Plot top 25 genes in the dataset</h3>
<p>The most strongly and commonly expressed genes expected among all
cells are ribosomal and mitochondrial.</p>
<pre class="r"><code>#Check top 20 expressed genes after filtering

rel_expression &lt;- t( t(counts(sce.filtered)) / colSums(counts(sce.filtered))) * 100
rownames(rel_expression) &lt;- rowData(sce.filtered)$Symbol
most_expressed &lt;- sort(rowSums( rel_expression ),T)[20:1]
plot_data &lt;- as.matrix(t(rel_expression[names(most_expressed),]))

par(cex.lab=0.75)
boxplot(plot_data, cex=0.1, las=1, xlab=&quot;% total count per cell&quot;, horizontal=TRUE, main=&quot;Distribution of counts for the top 20 genes before filtering&quot;)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotTop25GenesAfterFiltering-1">
Past versions of PlotTop25GenesAfterFiltering-1.png
</button>
</p>
<div id="fig-PlotTop25GenesAfterFiltering-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>rm(plot_data,rel_expression)
gc()</code></pre>
<pre><code>            used   (Mb) gc trigger    (Mb) limit (Mb)   max used    (Mb)
Ncells   8449640  451.3   14997121   801.0         NA   14997121   801.0
Vcells 745145493 5685.1 2458152581 18754.3     102400 1987126487 15160.6</code></pre>
</div>
</div>
<div id="normalization" class="section level2">
<h2>Normalization</h2>
<p>The preprocessing step of normalization aims to adjust the raw counts
in the dataset for variable sampling effects by scaling the observable
variance to a specified range. Several normalization techniques are used
in practice varying in complexity.</p>
<div id="normalization-by-library-size" class="section level3">
<h3>Normalization by Library size</h3>
<p>Library size normalization is the simplest strategy for performing
scaling normalization. The library size is defined as the total sum of
counts across all genes for each cell, the expected value of which is
assumed to scale with any cell-specific biases. The “library size
factor” for each cell is then directly proportional to its library size
where the proportionality constant is defined such that the mean size
factor across all cells is equal to 1.</p>
<pre class="r"><code># Library size normalization
sce.lib &lt;- computeLibraryFactors(sce.filtered)


ggplot(data.frame(&quot;log10libSf&quot;=log10(sizeFactors(sce.lib))), aes(x=log10libSf)) +
  xlab(&quot;Log10 Library size factor&quot;) +
  geom_histogram(bins=50)+
  ggtitle(&quot;Distribution of Library size factors&quot;)+
  theme_bw()</code></pre>
<p><img src="figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-LibrarySizeNorm-1">
Past versions of LibrarySizeNorm-1.png
</button>
</p>
<div id="fig-LibrarySizeNorm-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="normalization-by-deconvolution" class="section level3">
<h3>Normalization by Deconvolution</h3>
<p>Deconvolution aims to normalize expression values based on summed
values from pools of cells which reduces composition biases that are
present when any unbalanced differential expression exists between
samples. Pooling counts from many cells to increase the size of the
counts for accurate size factor estimation. Pool-based size factors are
then “deconvolved” into cell-based factors for normalization of each
cell’s expression profile.</p>
<pre class="r"><code># Normalization by deconvolution
clust.filtered &lt;- quickCluster(sce.filtered, BPPARAM =bpp)

sce.deconv &lt;- computeSumFactors(sce.filtered,clusters=clust.filtered, min.mean = 0.1, BPPARAM =bpp)

ggplot(data.frame(&quot;log10libSf&quot;=log10(sizeFactors(sce.deconv))), aes(x=log10libSf)) +
  xlab(&quot;Log10 Library size factor&quot;) +
  geom_histogram(bins=50)+
  ggtitle(&quot;Distribution of Deconvolution size factors&quot;)+
  theme_bw()</code></pre>
<p><img src="figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-DeconvolutionNorm-1">
Past versions of DeconvolutionNorm-1.png
</button>
</p>
<div id="fig-DeconvolutionNorm-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>print(&quot;Library size factors&quot;)</code></pre>
<pre><code>[1] &quot;Library size factors&quot;</code></pre>
<pre class="r"><code>summary(sizeFactors(sce.lib))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0498  0.4277  0.7730  1.0000  1.3431  6.6151 </code></pre>
<pre class="r"><code>print(&quot;Deconvolution size factors&quot;)</code></pre>
<pre><code>[1] &quot;Deconvolution size factors&quot;</code></pre>
<pre class="r"><code>summary(sizeFactors(sce.deconv))</code></pre>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.002228 0.431166 0.782989 1.000000 1.333023 7.964701 </code></pre>
<div id="plot-deconvolution-against-dibrary-size-factors"
class="section level4 tabset">
<h4 class="tabset">Plot Deconvolution against Dibrary Size Factors</h4>
<p>Deconvolution size factor for each cell in the dataset, compared to
the equivalent size factor derived from the library size. The red line
corresponds to identity between the two size factors. Check that the
estimated library sizes are not too far from the library size factors,
estimated from the total number of counts.</p>
<div id="color-by-individual-cluster" class="section level5">
<h5>Color by Individual Cluster</h5>
<pre class="r"><code>#Color by individual cluster

 data.frame(LibrarySizeFactors = unname(sizeFactors(sce.lib)), DeconvolutionSizeFactors = sizeFactors(sce.deconv),Cluster = as.integer(clust.filtered)) %&gt;%
     ggplot(aes(x=LibrarySizeFactors, y=DeconvolutionSizeFactors)) +
     geom_point(aes(col=factor(Cluster))) +
     geom_abline(slope = 1, intercept = 0) + theme_classic() + theme(legend.key.size = unit(0.5, &#39;cm&#39;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotSizeFactors1-1">
Past versions of PlotSizeFactors1-1.png
</button>
</p>
<div id="fig-PlotSizeFactors1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="color-by-sample" class="section level5">
<h5>Color by Sample</h5>
<pre class="r"><code>#Color by sample
data.frame(LibrarySizeFactors = unname(sizeFactors(sce.lib)), DeconvolutionSizeFactors = sizeFactors(sce.deconv),Sample = sce.filtered$Sample) %&gt;%
     ggplot(aes(x=LibrarySizeFactors, y=DeconvolutionSizeFactors)) +
     geom_point(aes(col=Sample)) +
     geom_abline(slope = 1, intercept = 0) + theme_classic() + theme(legend.key.size = unit(0.5, &#39;cm&#39;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotSizeFactors2-1">
Past versions of PlotSizeFactors2-1.png
</button>
</p>
<div id="fig-PlotSizeFactors2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="apply-normalization" class="section level3">
<h3>Apply Normalization</h3>
<p>Apply the chosen normalization method</p>
<pre class="r"><code># Apply Normalisation
sce.filtered &lt;- logNormCounts(sce.deconv)
summary(sizeFactors(sce.filtered))</code></pre>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.002228 0.431166 0.782989 1.000000 1.333023 7.964701 </code></pre>
<pre class="r"><code>assayNames(sce.filtered)</code></pre>
<pre><code>[1] &quot;counts&quot;    &quot;logcounts&quot;</code></pre>
<pre class="r"><code>rm(sce.lib, sce.deconv)
gc()</code></pre>
<pre><code>            used   (Mb) gc trigger    (Mb) limit (Mb)   max used    (Mb)
Ncells   8505655  454.3   14997121   801.0         NA   14997121   801.0
Vcells 967710931 7383.1 2458152581 18754.3     102400 2388232136 18220.8</code></pre>
</div>
</div>
<div id="variable-level-metrics" class="section level2">
<h2>Variable-Level Metrics</h2>
<p>Variable-level metrics are computed by the getVarianceExplained()
function. This calculates the percentage of variance of each gene’s
expression that is explained by each variable in the colData of the
SingleCellExperiment object. We can then use this to determine which
experimental factors are contributing most to the variance in
expression. This is useful for diagnosing batch effects or to quickly
verify that a treatment has an effect.</p>
<pre class="r"><code>vars &lt;- getVarianceExplained(sce.filtered,assay.type=&quot;logcounts&quot;,
    variables=c(&quot;Sample&quot;, &quot;Joint.Location&quot;, &quot;Pathotype&quot;,&quot;Seropositivity&quot;,&quot;GCTreatment&quot;,&quot;Protocol&quot;,&quot;Sex&quot;,&quot;Age&quot;))
data.frame(head(vars))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sample"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Joint.Location"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pathotype"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Seropositivity"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["GCTreatment"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Protocol"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Sex"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Age"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.34312796","2":"0.002985743","3":"0.022667606","4":"0.0002243661","5":"0.0080871912","6":"1.018830e-03","7":"0.0186049386","8":"0.0057918752","_rn_":"ENSG00000238009.AL627309.1"},{"1":"0.03805161","2":"0.003804903","3":"0.002008516","4":"0.0041969877","5":"0.0014606275","6":"3.089980e-03","7":"0.0013947045","8":"0.0025465431","_rn_":"ENSG00000239945.AL627309.3"},{"1":"0.65421632","2":"0.035389727","3":"0.069751422","4":"0.0351635420","5":"0.0292983995","6":"5.917593e-03","7":"0.0505475117","8":"0.0437789970","_rn_":"ENSG00000241860.AL627309.5"},{"1":"0.11313103","2":"0.013952849","3":"0.032955351","4":"0.0065313504","5":"0.0034771101","6":"2.108639e-03","7":"0.0004874970","8":"0.0007380635","_rn_":"ENSG00000241599.AL627309.4"},{"1":"0.01728042","2":"0.007984584","3":"0.002180968","4":"0.0028091951","5":"0.0004244099","6":"3.819627e-05","7":"0.0001853042","8":"0.0002366200","_rn_":"ENSG00000229905.AL669831.2"},{"1":"0.97805144","2":"0.206519600","3":"0.130206760","4":"0.0661196589","5":"0.3608614695","6":"4.755392e-02","7":"0.0007948422","8":"0.3237721652","_rn_":"ENSG00000237491.LINC01409"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>plotExplanatoryVariables(vars)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/VariableMetrics-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-VariableMetrics-1">
Past versions of VariableMetrics-1.png
</button>
</p>
<div id="fig-VariableMetrics-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="save-dataset" class="section level2">
<h2>Save Dataset</h2>
<pre class="r"><code>dim(sce.filtered)</code></pre>
<pre><code>[1] 30426 63077</code></pre>
<pre class="r"><code>saveRDS(sce.filtered, file =paste0(path,&#39;/output/01_sce_QualityControl.rds&#39;))</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-apple-darwin20 (64-bit)
Running under: macOS Sonoma 14.4.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Warsaw
tzcode source: internal

attached base packages:
[1] grid      stats4    stats     graphics  grDevices utils     datasets 
[8] methods   base     

other attached packages:
 [1] gridExtra_2.3               scran_1.30.2               
 [3] scater_1.30.1               scuttle_1.12.0             
 [5] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0
 [7] Biobase_2.62.0              GenomicRanges_1.54.1       
 [9] GenomeInfoDb_1.38.8         IRanges_2.36.0             
[11] S4Vectors_0.40.2            BiocGenerics_0.48.1        
[13] MatrixGenerics_1.14.0       matrixStats_1.3.0          
[15] dplyr_1.1.4                 ggplot2_3.5.1              
[17] BiocParallel_1.36.0         here_1.0.1                 
[19] workflowr_1.7.1            

loaded via a namespace (and not attached):
 [1] bitops_1.0-7              rlang_1.1.3              
 [3] magrittr_2.0.3            git2r_0.33.0             
 [5] compiler_4.3.3            getPass_0.2-4            
 [7] DelayedMatrixStats_1.24.0 callr_3.7.6              
 [9] vctrs_0.6.5               stringr_1.5.1            
[11] pkgconfig_2.0.3           crayon_1.5.2             
[13] fastmap_1.1.1             XVector_0.42.0           
[15] labeling_0.4.3            utf8_1.2.4               
[17] promises_1.3.0            rmarkdown_2.26           
[19] ps_1.7.6                  ggbeeswarm_0.7.2         
[21] xfun_0.43                 bluster_1.12.0           
[23] zlibbioc_1.48.2           cachem_1.0.8             
[25] beachmat_2.18.1           jsonlite_1.8.8           
[27] highr_0.10                later_1.3.2              
[29] DelayedArray_0.28.0       irlba_2.3.5.1            
[31] parallel_4.3.3            cluster_2.1.6            
[33] R6_2.5.1                  bslib_0.7.0              
[35] stringi_1.8.4             limma_3.58.1             
[37] jquerylib_0.1.4           Rcpp_1.0.12              
[39] knitr_1.45                httpuv_1.6.15            
[41] Matrix_1.6-5              igraph_2.0.3             
[43] tidyselect_1.2.1          rstudioapi_0.16.0        
[45] abind_1.4-5               yaml_2.3.8               
[47] viridis_0.6.5             codetools_0.2-19         
[49] processx_3.8.4            lattice_0.22-5           
[51] tibble_3.2.1              withr_3.0.0              
[53] evaluate_0.23             pillar_1.9.0             
[55] whisker_0.4.1             generics_0.1.3           
[57] rprojroot_2.0.4           RCurl_1.98-1.14          
[59] sparseMatrixStats_1.14.0  munsell_0.5.1            
[61] scales_1.3.0              glue_1.7.0               
[63] metapod_1.10.1            tools_4.3.3              
[65] BiocNeighbors_1.20.2      ScaledMatrix_1.10.0      
[67] locfit_1.5-9.9            fs_1.6.4                 
[69] cowplot_1.1.3             edgeR_4.0.16             
[71] colorspace_2.1-0          GenomeInfoDbData_1.2.11  
[73] beeswarm_0.4.0            BiocSingular_1.18.0      
[75] vipor_0.4.7               cli_3.6.2                
[77] rsvd_1.0.5                fansi_1.0.6              
[79] S4Arrays_1.2.1            viridisLite_0.4.2        
[81] gtable_0.3.5              sass_0.4.9               
[83] digest_0.6.35             SparseArray_1.2.4        
[85] ggrepel_0.9.5             dqrng_0.3.2              
[87] farver_2.1.1              htmltools_0.5.8.1        
[89] lifecycle_1.0.4           httr_1.4.7               
[91] statmod_1.5.0            </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
