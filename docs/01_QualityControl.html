<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="SarahL." />


<title>Quality Control and Filtering</title>

<script src="site_libs/header-attrs-2.27/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">RA SingleCellAnalysis</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info"></span>
     
    About
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-bar-chart"></span>
     
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="00_DataPreparation.html">Data Preparation</a>
    </li>
    <li>
      <a href="01_QualityControl.html">Quality Control</a>
    </li>
    <li>
      <a href="02_DimensionalityReduction.html">Dimensionality Reduction</a>
    </li>
    <li>
      <a href="03_Integration_Batchelor.html">Integration</a>
    </li>
    <li>
      <a href="04_CellCycle.html">Cellcycle Assignement</a>
    </li>
    <li>
      <a href="05_Clustering.html">Clustering</a>
    </li>
    <li>
      <a href="06_CelltypeAnnotation.html">Annotation</a>
    </li>
    <li>
      <a href="07_Subclustering.html">Subclustering</a>
    </li>
  </ul>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sarloet/RA_SingleCellAnalysis">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Quality Control and Filtering</h1>
<h3 class="subtitle">01_QualityControl</h3>
<h4 class="author">SarahL.</h4>
<h4 class="date">Jun 13 2024 22:30:38</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2024-06-13
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>RA_SingleCellAnalysis/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date
</a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git
repository, you know the exact version of the code that produced these
results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20240328code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20240328)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20240328code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20240328)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomsarloetRASingleCellAnalysistreeba195bc605e0eb9b5f59bbb4eff395f8fe034a2ctargetblankba195bca">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/tree/ba195bc605e0eb9b5f59bbb4eff395f8fe034a2c" target="_blank">ba195bc</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomsarloetRASingleCellAnalysistreeba195bc605e0eb9b5f59bbb4eff395f8fe034a2ctargetblankba195bca"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/tree/ba195bc605e0eb9b5f59bbb4eff395f8fe034a2c" target="_blank">ba195bc</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/.DS_Store
    Ignored:    data/.DS_Store
    Ignored:    data/cellbender_data_h5/
    Ignored:    data/cellranger_data_h5/.DS_Store
    Ignored:    data/cellranger_data_h5/SynBio028_10000_w_introns/.DS_Store
    Ignored:    data/cellranger_data_h5/SynBio074_w_introns/.DS_Store
    Ignored:    data/cellranger_data_h5/SynBio076_w_introns/.DS_Store
    Ignored:    data/cellranger_data_h5/SynBio130_w_introns/.DS_Store
    Ignored:    output/00_DoubletDetection.rds
    Ignored:    output/00_sce_DataPreparation.rds
    Ignored:    output/01_sce_QualityControl.rds
    Ignored:    output/01_sce_QualityControl_cellfiltered.rds
    Ignored:    output/02_sce_DimensionalityReduction.rds
    Ignored:    output/03_sce_Integration_Batchelor.rds
    Ignored:    output/03_sce_Integration_Harmony.rds
    Ignored:    output/04_sce_CellCycle.rds
    Ignored:    output/05_sce_CelltypeAnnotation.rds
    Ignored:    output/05_sce_Clustering.rds
    Ignored:    output/06_sce_CelltypeAnnotation.rds
    Ignored:    output/07_sce_SC_Endothelial.rds
    Ignored:    output/07_sce_SC_Fibroblast.rds
    Ignored:    output/07_sce_SC_Fibroblast_Anno.rds
    Ignored:    output/07_sce_SC_Myeloid.rds
    Ignored:    output/07_sce_SC_Tcell.rds
    Ignored:    output/08_DifferentialAbundance_miloR.rds
    Ignored:    output/Cluster_Marker_Genes.xlsx
    Ignored:    output/Knee_KvM.csv
    Ignored:    output/Knee_KvW.csv
    Ignored:    output/MAST_KneeVsMCP.csv
    Ignored:    output/MAST_KneeVsWrist.csv
    Ignored:    output/MAST_MCPVsWrist.csv
    Ignored:    output/MCP_KvM.csv
    Ignored:    output/MCP_MvW.csv
    Ignored:    output/ManualAnno_L0_Wilcoxon.xlsx
    Ignored:    output/ManualAnno_L1_Wilcoxon.xlsx
    Ignored:    output/Wrist_KvW.csv
    Ignored:    output/Wrist_MvW.csv
    Ignored:    renv/library/
    Ignored:    renv/staging/

Unstaged changes:
    Modified:   analysis/02_DimensionalityReduction.Rmd
    Modified:   analysis/03_Integration_Batchelor.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown (<code>analysis/01_QualityControl.Rmd</code>) and
HTML (<code>docs/01_QualityControl.html</code>) files. If you’ve
configured a remote Git repository (see <code>?wflow_git_remote</code>),
click on the hyperlinks in the table below to view the files as they
were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/analysis/01_QualityControl.Rmd" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/01_QualityControl.html" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d24d8cc92001393c2858190589fd3e3fdf24a43f/analysis/01_QualityControl.Rmd" target="_blank">d24d8cc</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-04
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/analysis/01_QualityControl.Rmd" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/01_QualityControl.html" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/analysis/01_QualityControl.Rmd" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/01_QualityControl.html" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/analysis/01_QualityControl.Rmd" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/01_QualityControl.html" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/analysis/01_QualityControl.Rmd" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
<td>
fiv
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/01_QualityControl.html" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
<td>
fiv
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/906ed8cca35b490674aba343f419314d06637324/docs/01_QualityControl.html" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/1337447d6dad43c89fb5e05ea133d54768944fb9/docs/01_QualityControl.html" target="_blank">1337447</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-22
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/ed4a9caf149bb230a93515926649150ab4ffc913/docs/01_QualityControl.html" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/analysis/01_QualityControl.Rmd" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/01_QualityControl.html" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/b3be2d8d7d07ba0b228312155ededdff48935a5a/docs/01_QualityControl.html" target="_blank">b3be2d8</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-15
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/analysis/01_QualityControl.Rmd" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/01_QualityControl.html" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/analysis/01_QualityControl.Rmd" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/14ca55cb84c60cf353776c22d595167915b30d9b/docs/01_QualityControl.html" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/analysis/01_QualityControl.Rmd" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
<td>
fx
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/01_QualityControl.html" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
<td>
fx
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/analysis/01_QualityControl.Rmd" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/01_QualityControl.html" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/analysis/01_QualityControl.Rmd" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/sarloet/RA_SingleCellAnalysis/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/01_QualityControl.html" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
<td>
fix
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="quality-control-and-preprocessing" class="section level1">
<h1>Quality Control and Preprocessing</h1>
<div id="setup" class="section level2">
<h2>Setup</h2>
<div id="standard-packages" class="section level3">
<h3>Standard packages</h3>
<pre class="r"><code>library(here)
source(here(&quot;code&quot;, &quot;standard_libraries.R&quot;))</code></pre>
</div>
<div id="additional-packages" class="section level3">
<h3>Additional Packages</h3>
<pre class="r"><code>#Load Packages
suppressPackageStartupMessages({
library(grid)
})</code></pre>
</div>
<div id="set-parameter" class="section level3">
<h3>Set Parameter</h3>
<pre class="r"><code>set.seed(123)
bpp &lt;- BiocParallel::MulticoreParam(parallel::detectCores()-1, RNGseed=123)
path &lt;- here::here()</code></pre>
</div>
</div>
<div id="load-data" class="section level2">
<h2>Load Data</h2>
<pre class="r"><code>## Load the RA DATASET
sce &lt;- readRDS(file = paste0(path,&#39;/output/00_sce_DataPreparation.rds&#39;))</code></pre>
<div id="explore-dataset-dimensions" class="section level3">
<h3>Explore Dataset Dimensions</h3>
<pre class="r"><code>#Dimensions of count matrix
dim(sce)</code></pre>
<pre><code>[1] 34550 76772</code></pre>
</div>
<div id="histogramm-with-number-of-cells" class="section level3 tabset">
<h3 class="tabset">Histogramm with number of cells</h3>
<p>Show the number of cells detected in each sample or joint location
before filtering</p>
<div id="per-sample" class="section level4">
<h4>Per Sample</h4>
<pre class="r"><code>#Histogramm with number of cells per Sample
ggplot(as.data.frame(colData(sce)), aes(x=Sample))+geom_bar()+ coord_flip()+ ggtitle(&quot;Number of cells per sample&quot;) + 
  theme_classic()+
  stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.65))+
  theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank())+
  scale_y_continuous(expand = c(0,0))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsPerSample-1">
Past versions of PlotCellsPerSample-1.png
</button>
</p>
<div id="fig-PlotCellsPerSample-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsPerSample-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>data.frame(as.list(table(colData(sce)$Sample)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["SynBio_028"],"name":[1],"type":["int"],"align":["right"]},{"label":["SynBio_049"],"name":[2],"type":["int"],"align":["right"]},{"label":["SynBio_050"],"name":[3],"type":["int"],"align":["right"]},{"label":["SynBio_074"],"name":[4],"type":["int"],"align":["right"]},{"label":["SynBio_076"],"name":[5],"type":["int"],"align":["right"]},{"label":["SynBio_077a"],"name":[6],"type":["int"],"align":["right"]},{"label":["SynBio_077b"],"name":[7],"type":["int"],"align":["right"]},{"label":["SynBio_081"],"name":[8],"type":["int"],"align":["right"]},{"label":["SynBio_083"],"name":[9],"type":["int"],"align":["right"]},{"label":["SynBio_084"],"name":[10],"type":["int"],"align":["right"]},{"label":["SynBio_087"],"name":[11],"type":["int"],"align":["right"]},{"label":["SynBio_093"],"name":[12],"type":["int"],"align":["right"]},{"label":["SynBio_096"],"name":[13],"type":["int"],"align":["right"]},{"label":["SynBio_098a"],"name":[14],"type":["int"],"align":["right"]},{"label":["SynBio_098b"],"name":[15],"type":["int"],"align":["right"]},{"label":["SynBio_127"],"name":[16],"type":["int"],"align":["right"]}],"data":[{"1":"3924","2":"671","3":"4984","4":"4137","5":"2513","6":"6307","7":"6293","8":"6360","9":"5232","10":"4886","11":"3385","12":"5829","13":"6785","14":"5257","15":"6312","16":"3897"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="per-joint-location" class="section level4">
<h4>Per Joint Location</h4>
<pre class="r"><code>#Histogramm with number of cells per Joint
ggplot(as.data.frame(colData(sce)), aes(x=Joint.Location))+geom_bar()+ coord_flip()+ ggtitle(&quot;Number of cells per Joint&quot;) + 
  theme_classic()+
  stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.8))+
  theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank())+
  scale_y_continuous(expand = c(0,0))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsJoint-1">
Past versions of PlotCellsJoint-1.png
</button>
</p>
<div id="fig-PlotCellsJoint-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsJoint-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>data.frame(as.list(table(colData(sce)$Joint.Location)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Knee"],"name":[1],"type":["int"],"align":["right"]},{"label":["MCP"],"name":[2],"type":["int"],"align":["right"]},{"label":["Wrist"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"28075","2":"16853","3":"31844"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</div>
<div id="filter-cells" class="section level2">
<h2>Filter Cells</h2>
<p>The main goal of quality control is to remove low-quality reads from
the dataset. When a cell has a low number of detected genes, a low count
depth and a high fraction of mitochondrial counts it might have a broken
membrane which can indicate a dying cell.</p>
<p>We filter for: - Low and high number of counts per barcode (count
depth) - Low and high number of genes per barcode - High fraction of
counts from mitochondrial genes per barcode - High fraction of counts
from HBB genes per barcode (erythrocytes)</p>
<pre class="r"><code># Indentify mitochondrial genes
is_mito&lt;- grepl(&quot;(^MT-)|(^mt-)&quot;, rowData(sce)$Symbol)
cat(&quot;Mitochondrial genes:&quot;, rowData(sce)$Symbol[is_mito]) #Show the MT genes</code></pre>
<pre><code>Mitochondrial genes: MT-ND1 MT-ND2 MT-CO1 MT-CO2 MT-ATP8 MT-ATP6 MT-CO3 MT-ND3 MT-ND4L MT-ND4 MT-ND5 MT-ND6 MT-CYB</code></pre>
<pre class="r"><code># Indentify HBB genes
is_hbb&lt;- grepl(&quot;(^HBB)|(^hbb)&quot;, rowData(sce)$Symbol)
cat(&quot;HBB genes:&quot;, rowData(sce)$Symbol[is_hbb]) #Show the HBB genes</code></pre>
<pre><code>HBB genes: HBB</code></pre>
<pre class="r"><code># Indentify Ribosomal genes
is_ribo&lt;- grepl(&quot;(^RPL)|(^RPS)|(^rpl)|(^rps)&quot;, rowData(sce)$Symbol) 
cat(&quot;Ribosomal genes:&quot;, rowData(sce)$Symbol[is_ribo])#Show the Ribo genes</code></pre>
<pre><code>Ribosomal genes: RPL22 RPL11 RPS6KA1 RPS8 RPL5 RPS27 RPS6KC1 RPS7 RPS27A RPL31 RPL37A RPL32 RPL15 RPSA RPL14 RPL29 RPL24 RPL22L1 RPL39L RPL35A RPL9 RPL34-AS1 RPL34 RPS3A RPL37 RPS23 RPS14 RPL26L1 RPS18 RPS10-NUDT3 RPS10 RPL10A RPL7L1 RPS12 RPS6KA2 RPS6KA2-IT1 RPS6KA2-AS1 RPS20 RPL7 RPL30 RPL8 RPS6 RPL35 RPL12 RPL7A RPS24 RPLP2 RPL27A RPS13 RPS6KA4 RPS6KB2 RPS6KB2-AS1 RPS3 RPS25 RPS26 RPL41 RPL6 RPLP0 RPL21 RPL10L RPS29 RPL36AL RPS6KL1 RPS6KA5 RPS27L RPL4 RPLP1 RPS17 RPL3L RPS2 RPS15A RPL13 RPL26 RPL23A RPL23 RPL19 RPL27 RPS6KB1 RPL38 RPL17 RPS15 RPL36 RPS28 RPL18A RPS16 RPS19 RPL18 RPL13A RPS11 RPS9 RPL28 RPS5 RPS21 RPL3 RPS19BP1 RPS6KA3 RPS4X RPS6KA6 RPL36A RPL39 RPL10 RPS4Y1 RPS4Y2</code></pre>
<pre class="r"><code># calculate per-cell quality control (QC) metrics using scater
sce &lt;- addPerCellQC(sce, subsets=list(Mito=is_mito, Hbb=is_hbb, Ribo=is_ribo))</code></pre>
<div id="fixed-filtering-thresholds" class="section level3">
<h3>Fixed Filtering Thresholds</h3>
<pre class="r"><code>#Some Fixed thresholds
colData(sce)$qc.count_manual &lt;- sce$sum &lt; 400 |sce$sum &gt; 100000 # Cells have at least a count of 400 |sce$sum &gt; 100000
colData(sce)$qc.genexp_manual &lt;- sce$detected &lt; 300 | sce$detected &gt; 10000  # Cells have at least 300 genes expressed 
colData(sce)$qc.mito_manual &lt;- sce$subsets_Mito_percent &gt; 15 #Mitochondrial contamination has to be lower than 15%
colData(sce)$qc.hbb_manual &lt;- sce$subsets_Hbb_percent &gt; 5 #Remove cells expressing HBB (erythrocytes)</code></pre>
<pre class="r"><code>#Some Fixed thresholds
hist(sce$total,breaks = 100,main =&quot;UMI distribution&quot;,xlab =&quot;UMI&quot;)
abline(v = 400, col = &quot;red&quot;)
abline(v = 100000, col = &quot;red&quot;)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/SumHisto-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-SumHisto-1">
Past versions of SumHisto-1.png
</button>
</p>
<div id="fig-SumHisto-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/SumHisto-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>#Some Fixed thresholds
hist(sce$detected,breaks = 100, main =&quot;Detected gene distribution&quot;,xlab =&quot;Detected&quot;)
abline(v = 300, col = &quot;red&quot;)
abline(v = 10000, col = &quot;red&quot;)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/DetectedHisto-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-DetectedHisto-1">
Past versions of DetectedHisto-1.png
</button>
</p>
<div id="fig-DetectedHisto-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/DetectedHisto-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="adaptive-filtering-thresholds-for-each-batchsample"
class="section level3">
<h3>Adaptive Filtering Thresholds (for each batch/sample)</h3>
<pre class="r"><code># Detect cells with very low number of counts
colData(sce)$qc.count &lt;- isOutlier(sce$sum,nmads=3, log=TRUE, type=&quot;both&quot;,batch =sce$Sample )
data.frame(t(attr(colData(sce)$qc.count, &quot;thresholds&quot;)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["lower"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["higher"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1903.31939","2":"82106.56","_rn_":"SynBio_028"},{"1":"408.10070","2":"464555.34","_rn_":"SynBio_049"},{"1":"237.69892","2":"287520.40","_rn_":"SynBio_050"},{"1":"444.61130","2":"283900.17","_rn_":"SynBio_074"},{"1":"362.70463","2":"176628.61","_rn_":"SynBio_076"},{"1":"1051.05777","2":"117605.26","_rn_":"SynBio_077a"},{"1":"1643.26899","2":"164753.38","_rn_":"SynBio_077b"},{"1":"765.31423","2":"281951.39","_rn_":"SynBio_081"},{"1":"1268.96618","2":"101857.84","_rn_":"SynBio_083"},{"1":"961.00297","2":"175263.23","_rn_":"SynBio_084"},{"1":"335.97811","2":"210063.69","_rn_":"SynBio_087"},{"1":"623.41596","2":"123485.89","_rn_":"SynBio_093"},{"1":"312.01016","2":"300504.60","_rn_":"SynBio_096"},{"1":"356.97924","2":"140537.27","_rn_":"SynBio_098a"},{"1":"10.00917","2":"1627437.27","_rn_":"SynBio_098b"},{"1":"459.11907","2":"134663.91","_rn_":"SynBio_127"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Detect cells with very low number of genes
colData(sce)$qc.genexp &lt;- isOutlier(sce$detected,nmads=3, log=TRUE, type=&quot;both&quot;,batch =sce$Sample)
data.frame(t(attr(colData(sce)$qc.genexp, &quot;thresholds&quot;)))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["lower"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["higher"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"1143.40365","2":"12252.93","_rn_":"SynBio_028"},{"1":"511.21758","2":"27787.31","_rn_":"SynBio_049"},{"1":"283.78078","2":"26921.12","_rn_":"SynBio_050"},{"1":"451.44869","2":"23167.10","_rn_":"SynBio_074"},{"1":"409.31065","2":"17850.03","_rn_":"SynBio_076"},{"1":"878.87587","2":"12876.10","_rn_":"SynBio_077a"},{"1":"1192.00256","2":"14364.94","_rn_":"SynBio_077b"},{"1":"785.46990","2":"20181.99","_rn_":"SynBio_081"},{"1":"939.83815","2":"11657.43","_rn_":"SynBio_083"},{"1":"868.34774","2":"15418.11","_rn_":"SynBio_084"},{"1":"285.06157","2":"24858.64","_rn_":"SynBio_087"},{"1":"607.39177","2":"15065.44","_rn_":"SynBio_093"},{"1":"393.53578","2":"25631.66","_rn_":"SynBio_096"},{"1":"334.05153","2":"17401.27","_rn_":"SynBio_098a"},{"1":"23.53851","2":"127443.21","_rn_":"SynBio_098b"},{"1":"393.87963","2":"18289.49","_rn_":"SynBio_127"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Detect cells with high mitochondrial content
colData(sce)$qc.mito &lt;- isOutlier(sce$subsets_Mito_percent,nmads=3, type=&quot;higher&quot;,batch =sce$Sample)
data.frame(t(attr(colData(sce)$qc.mito, &quot;thresholds&quot;))) </code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["lower"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["higher"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"-Inf","2":"12.585015","_rn_":"SynBio_028"},{"1":"-Inf","2":"11.445092","_rn_":"SynBio_049"},{"1":"-Inf","2":"16.882849","_rn_":"SynBio_050"},{"1":"-Inf","2":"15.449682","_rn_":"SynBio_074"},{"1":"-Inf","2":"13.937915","_rn_":"SynBio_076"},{"1":"-Inf","2":"15.776733","_rn_":"SynBio_077a"},{"1":"-Inf","2":"14.732160","_rn_":"SynBio_077b"},{"1":"-Inf","2":"10.917757","_rn_":"SynBio_081"},{"1":"-Inf","2":"9.610198","_rn_":"SynBio_083"},{"1":"-Inf","2":"12.640024","_rn_":"SynBio_084"},{"1":"-Inf","2":"9.222400","_rn_":"SynBio_087"},{"1":"-Inf","2":"16.085914","_rn_":"SynBio_093"},{"1":"-Inf","2":"14.273353","_rn_":"SynBio_096"},{"1":"-Inf","2":"16.722518","_rn_":"SynBio_098a"},{"1":"-Inf","2":"15.520654","_rn_":"SynBio_098b"},{"1":"-Inf","2":"16.886348","_rn_":"SynBio_127"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code># Mark all Cells to be Discarted
colData(sce)$discard &lt;- sce$qc.count | sce$qc.count_manual | sce$qc.genexp | sce$qc.genexp_manual | sce$qc.mito | sce$qc.mito_manual | sce$qc.hbb_manual</code></pre>
<pre class="r"><code># Summary of all discarted cells
t(data.frame(`Library_size` = sum(sce$qc.count | sce$qc.count_manual),
           `Genes_detected` = sum(sce$qc.genexp| sce$qc.genexp_manual),
           `Mitochondrial_percentage` = sum(sce$qc.mito| sce$qc.mito_manual),
           `HBB_expression` = sum(sce$qc.hbb_manual),
           Total_discarded = sum(sce$discard)))</code></pre>
<pre><code>                          [,1]
Library_size              2728
Genes_detected            6541
Mitochondrial_percentage  7800
HBB_expression              51
Total_discarded          12133</code></pre>
</div>
<div id="qc-filtering-plots" class="section level3">
<h3>QC Filtering Plots</h3>
<p>The aim by plotting the proportion of mitochondrial counts against
some of the other QC metrics is to confirm that there are no cells with
both large total counts and large mitochondrial counts, to ensure that
we are not inadvertently removing high-quality cells that happen to be
highly metabolically active (e.g., hepatocytes).</p>
<div id="scatter-plots-per-sample" class="section level4 tabset">
<h4 class="tabset">Scatter Plots Per Sample</h4>
<div id="detected-genes-vs-total-number-of-umis" class="section level5">
<h5>Detected genes vs total number of UMIs</h5>
<pre class="r"><code>colData(sce) %&gt;% 
    as.data.frame() %&gt;% 
    arrange(discard) %&gt;% 
    ggplot(aes(x = sum, y = detected)) +
      geom_point(aes(colour = discard),size=0.5) + 
      facet_wrap(vars(Sample))+
      labs(title=&quot;Total number of detected genes plotted against total number of UMIs&quot;,
       x=&quot;Total counts&quot;,
       y=&quot;Detected genes&quot;) +
      ggtitle(&quot;Total number of detected genes plotted against total number of UMIs&quot;) + 
      theme(strip.background=element_rect(fill=&quot;white&quot;), panel.background = element_rect(fill = NA),axis.line = element_line(colour = &quot;black&quot;)) + 
      scale_fill_manual(values = c(&quot;#4dc8c9&quot;,&quot;#FB8072&quot;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots1-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots1-1">
Past versions of QcPlots1-1.png
</button>
</p>
<div id="fig-QcPlots1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots1-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="mitochondrial-percentage-vs-total-number-of-umis"
class="section level5">
<h5>Mitochondrial percentage vs total number of UMIs</h5>
<pre class="r"><code>colData(sce) %&gt;% 
    as.data.frame() %&gt;% 
    arrange(discard) %&gt;% 
    ggplot(aes(x = sum, y = subsets_Mito_percent)) +
      geom_point(aes(colour = discard),size=0.5) + 
      facet_wrap(vars(Sample)) +
      labs(title=&quot;Percentage of mitochondrial UMIs plotted against total number of UMIs&quot;,
       x=&quot;Total counts&quot;,
       y=&quot;Mitochondrial UMIs [%]&quot;) +
      theme(strip.background=element_rect(fill=&quot;white&quot;), panel.background = element_rect(fill = NA),axis.line = element_line(colour = &quot;black&quot;)) + 
      scale_fill_manual(values = c(&quot;#4dc8c9&quot;,&quot;#FB8072&quot;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots2-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots2-1">
Past versions of QcPlots2-1.png
</button>
</p>
<div id="fig-QcPlots2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots2-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="violin-plots-per-sample" class="section level4 tabset">
<h4 class="tabset">Violin Plots Per Sample</h4>
<div id="total-counts" class="section level5">
<h5>Total counts</h5>
<pre class="r"><code>#Plot Total count
plotColData(sce, x=&quot;Sample&quot;, y=&quot;sum&quot;,other_fields=&quot;Sample&quot;,colour_by = &quot;discard&quot;) + 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) + 
    scale_y_log10() + 
    ggtitle(&quot;Total count&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots3-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots3-1">
Past versions of QcPlots3-1.png
</button>
</p>
<div id="fig-QcPlots3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots3-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="genes-detected" class="section level5">
<h5>Genes detected</h5>
<pre class="r"><code>#Plot Detected Genes
plotColData(sce, x=&quot;Sample&quot;, y=&quot;detected&quot;, other_fields=&quot;Sample&quot;,colour_by =&quot;discard&quot;)+ 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) + 
    scale_y_log10() + 
    ggtitle(&quot;Detected features&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots4-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots4-1">
Past versions of QcPlots4-1.png
</button>
</p>
<div id="fig-QcPlots4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots4-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="mitochondrial-percentage" class="section level5">
<h5>Mitochondrial percentage</h5>
<pre class="r"><code>#Plot Mito percent
plotColData(sce, x=&quot;Sample&quot;, y=&quot;subsets_Mito_percent&quot;, other_fields=&quot;Sample&quot;,colour_by = data.frame(factor(sce$qc.mito | sce$qc.mito_manual,levels=c(FALSE,TRUE)))) + 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) +
    ggtitle(&quot;Mito percent&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1,), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots5-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots5-1">
Past versions of QcPlots5-1.png
</button>
</p>
<div id="fig-QcPlots5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots5-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="hbb-percentage" class="section level5">
<h5>HBB percentage</h5>
<pre class="r"><code>#Plot Mito percent
plotColData(sce, x=&quot;Sample&quot;, y=&quot;subsets_Hbb_percent&quot;, other_fields=&quot;Sample&quot;,colour_by = data.frame(factor(sce$qc.hbb_manual,levels=c(FALSE,TRUE)))) + 
    facet_wrap(~Sample, nrow=1, scales = &quot;free_x&quot;) +
    ggtitle(&quot;HBB percent&quot;)+
    guides(colour=guide_legend(title=&quot;Discarded&quot;))+
    theme(axis.text.x = element_text(angle = 45,hjust=1,), axis.ticks.x=element_blank(),strip.text.x = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlotshbb-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlotshbb-1">
Past versions of QcPlotshbb-1.png
</button>
</p>
<div id="fig-QcPlotshbb-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlotshbb-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="cells-to-be-removed-histogramm" class="section level4 tabset">
<h4 class="tabset">Cells to be Removed Histogramm</h4>
<div id="absolute-comparison" class="section level5">
<h5>Absolute comparison</h5>
<pre class="r"><code>#Cells marked to be dropped per samples
# Absolute comparison / by sample
as.data.frame(colData(sce)) %&gt;%
  group_by(Sample, discard) %&gt;%
  summarise(Freq=n()) %&gt;% 
  ggplot(aes(x=Sample, y=Freq, fill=discard, label=Freq)) +
    geom_bar(stat=&quot;identity&quot;, position=&quot;stack&quot;) +
    labs(title=&quot;Cells to be dropped&quot;,
       subtitle=&quot;Labels represent absolute number of cells&quot;,
       x=&quot;&quot;,
       y=&quot;Number of cells&quot;) + 
    geom_text(size=3, position = position_stack(vjust=0.5))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.line = element_line(colour = &quot;black&quot;), panel.background = element_rect(fill = NA)) + 
    scale_fill_manual(values = c(&quot;#4dc8c9&quot;,&quot;#FB8072&quot;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots6-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots6-1">
Past versions of QcPlots6-1.png
</button>
</p>
<div id="fig-QcPlots6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots6-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="relative-comparison" class="section level5">
<h5>Relative comparison</h5>
<pre class="r"><code>#Cells marked to be dropped per samples
# Relative comparison / by sample
as.data.frame(colData(sce)) %&gt;%
  group_by(Sample, discard) %&gt;%
  summarise(Freq=n()) %&gt;% 
  ggplot(aes(x=Sample, y=Freq, fill=discard, label=Freq)) +
    geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;) +
    labs(title=&quot;Cells to be dropped&quot;,
       subtitle=&quot;Labels represent absolute number of cells&quot;,
       x=&quot;&quot;,
       y=&quot;Number of cells&quot;) + 
    geom_text(size=3, position = position_fill(vjust=0.5))+
    theme(axis.text.x = element_text(angle = 45,hjust=1), axis.line = element_line(colour = &quot;black&quot;), panel.background = element_rect(fill = NA))+ 
    scale_fill_manual(values = c(&quot;#4dc8c9&quot;,&quot;#FB8072&quot;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/QcPlots7-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-QcPlots7-1">
Past versions of QcPlots7-1.png
</button>
</p>
<div id="fig-QcPlots7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/QcPlots7-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="apply-filtering" class="section level3">
<h3>Apply filtering</h3>
<pre class="r"><code># Create the filtered sce element
sce.filtered &lt;- sce[, !colData(sce)$discard]

cat(
    &quot;NR of Cells Before Filtering &quot;, dim(sce)[2],
    &quot;\nNR of Cells After Filtering &quot;, dim(sce.filtered)[2],
    &quot;\nNR of Cells Filtered out &quot;, dim(sce)[2] - dim(sce.filtered)[2],
    &quot;\nCells Filtered out: [%]&quot;, (dim(sce)[2] - dim(sce.filtered)[2])/dim(sce)[2]*100
    )</code></pre>
<pre><code>NR of Cells Before Filtering  76772 
NR of Cells After Filtering  64639 
NR of Cells Filtered out  12133 
Cells Filtered out: [%] 15.80394</code></pre>
<div id="save-cell-filtered-data" class="section level4">
<h4>Save cell filtered Data</h4>
<pre class="r"><code>saveRDS(sce.filtered, file =paste0(path,&#39;/output/01_sce_QualityControl_cellfiltered.rds&#39;))</code></pre>
</div>
</div>
</div>
<div id="filter-genes" class="section level2">
<h2>Filter Genes</h2>
<p>Additionally, perform some filtering by prevalence. If a gene is only
expressed in a handful of cells, it is not particularly meaningful as it
still brings down the averages for all other cells it is not expressed
in. For this dataset we choose to keep only genes which are expressed in
10 or more cells. This should be performed after filtering out for low
quality cells.</p>
<pre class="r"><code>#Filter out genes 
dim_before_filtering &lt;- dim(sce.filtered)

#Get only the detected Genes
detected_genes &lt;- rowSums(counts(sce.filtered)&gt; 0)

#Remove Genes not expressed in at least 10 Cells 
sce.filtered &lt;- sce.filtered[detected_genes &gt; 10,]


dim_after_filtering &lt;- dim(sce.filtered)

cat(
    &quot;NR of Genes Before Filtering &quot;, dim_before_filtering[1],
    &quot;\nNR of Genes After Filtering &quot;, dim_after_filtering[1],
    &quot;\nNR of Genes Filtered out &quot;, dim_before_filtering[1] - dim_after_filtering[1],
    &quot;\nGenes Filtered out: [%]&quot;, (dim_before_filtering[1] - dim_after_filtering[1])/dim_before_filtering[1]*100
    )</code></pre>
<pre><code>NR of Genes Before Filtering  34550 
NR of Genes After Filtering  30488 
NR of Genes Filtered out  4062 
Genes Filtered out: [%] 11.75687</code></pre>
</div>
<div id="plots-after-filtering" class="section level2">
<h2>Plots after Filtering</h2>
<div id="histogramm-with-number-of-cells-1"
class="section level3 tabset">
<h3 class="tabset">Histogramm with number of cells</h3>
<p>Show the number of cells detected in each sample or joint location
after filtering</p>
<div id="per-sample-1" class="section level4">
<h4>Per Sample</h4>
<pre class="r"><code>#Histogramm with number of cells per sample after filtering
ggplot(as.data.frame(colData(sce.filtered)), aes(x=Sample))+geom_bar()+ coord_flip()+ ggtitle(&quot;Number of cells per sample&quot;) + 
  theme_classic()+
  stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.65))+
  theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank())+
  scale_y_continuous(expand = c(0,0))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsPerSampleAfterFiltering1-1">
Past versions of PlotCellsPerSampleAfterFiltering1-1.png
</button>
</p>
<div id="fig-PlotCellsPerSampleAfterFiltering1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsPerSampleAfterFiltering1-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>t(data.frame(as.list(table(colData(sce.filtered)$Sample))))</code></pre>
<pre><code>            [,1]
SynBio_028  3451
SynBio_049   549
SynBio_050  4218
SynBio_074  3457
SynBio_076  2169
SynBio_077a 5394
SynBio_077b 5419
SynBio_081  5490
SynBio_083  4317
SynBio_084  4105
SynBio_087  2859
SynBio_093  4860
SynBio_096  5913
SynBio_098a 4122
SynBio_098b 5167
SynBio_127  3149</code></pre>
</div>
<div id="per-joint-location-1" class="section level4">
<h4>Per Joint Location</h4>
<pre class="r"><code>#Histogramm with number of cells per Joint after filtering
ggplot(as.data.frame(colData(sce.filtered)), aes(x=Joint.Location))+geom_bar()+ coord_flip()+ ggtitle(&quot;Number of cells per Joint&quot;) + 
  theme_classic()+
  stat_count(geom = &quot;text&quot;, colour = &quot;white&quot;, size = 3.5,aes(label = ..count..),position=position_stack(vjust=0.8))+
  theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank())+
  scale_y_continuous(expand = c(0,0))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotCellsPerJointAfterFiltering2-1">
Past versions of PlotCellsPerJointAfterFiltering2-1.png
</button>
</p>
<div id="fig-PlotCellsPerJointAfterFiltering2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotCellsPerJointAfterFiltering2-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>t(data.frame(as.list(table(colData(sce.filtered)$Joint.Location))))</code></pre>
<pre><code>       [,1]
Knee  23438
MCP   14518
Wrist 26683</code></pre>
</div>
</div>
<div id="plot-top-25-genes-in-the-dataset" class="section level3">
<h3>Plot top 25 genes in the dataset</h3>
<p>The most strongly and commonly expressed genes expected among all
cells are ribosomal and mitochondrial.</p>
<pre class="r"><code>#Check top 20 expressed genes after filtering

rel_expression &lt;- t( t(counts(sce.filtered)) / colSums(counts(sce.filtered))) * 100
rownames(rel_expression) &lt;- rowData(sce.filtered)$Symbol
most_expressed &lt;- sort(rowSums( rel_expression ),T)[20:1]
plot_data &lt;- as.matrix(t(rel_expression[names(most_expressed),]))

par(cex.lab=0.75)
boxplot(plot_data, cex=0.1, las=1, xlab=&quot;% total count per cell&quot;, horizontal=TRUE, main=&quot;Distribution of counts for the top 20 genes before filtering&quot;)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotTop25GenesAfterFiltering-1">
Past versions of PlotTop25GenesAfterFiltering-1.png
</button>
</p>
<div id="fig-PlotTop25GenesAfterFiltering-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotTop25GenesAfterFiltering-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>rm(plot_data,rel_expression)
gc()</code></pre>
<pre><code>            used   (Mb) gc trigger    (Mb) limit (Mb)   max used    (Mb)
Ncells  10343107  552.4   16904908   902.9         NA   16904908   902.9
Vcells 749530886 5718.5 2416800420 18438.8     102400 1954673158 14913.0</code></pre>
</div>
</div>
<div id="normalization" class="section level2">
<h2>Normalization</h2>
<p>The preprocessing step of normalization aims to adjust the raw counts
in the dataset for variable sampling effects by scaling the observable
variance to a specified range. Several normalization techniques are used
in practice varying in complexity.</p>
<div id="normalization-by-library-size" class="section level3">
<h3>Normalization by Library size</h3>
<p>Library size normalization is the simplest strategy for performing
scaling normalization. The library size is defined as the total sum of
counts across all genes for each cell, the expected value of which is
assumed to scale with any cell-specific biases. The “library size
factor” for each cell is then directly proportional to its library size
where the proportionality constant is defined such that the mean size
factor across all cells is equal to 1.</p>
<pre class="r"><code># Library size normalization
sce.lib &lt;- computeLibraryFactors(sce.filtered)

# Plot library size factors
ggplot(data.frame(&quot;log10libSf&quot;=log10(sizeFactors(sce.lib))), aes(x=log10libSf)) +
  xlab(&quot;Log10 Library size factor&quot;) +
  geom_histogram(bins=50)+
  ggtitle(&quot;Distribution of Library size factors&quot;)+
  theme_bw()+
  theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-LibrarySizeNorm-1">
Past versions of LibrarySizeNorm-1.png
</button>
</p>
<div id="fig-LibrarySizeNorm-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/LibrarySizeNorm-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="normalization-by-deconvolution" class="section level3">
<h3>Normalization by Deconvolution</h3>
<p>Deconvolution aims to normalize expression values based on summed
values from pools of cells which reduces composition biases that are
present when any unbalanced differential expression exists between
samples. Pooling counts from many cells to increase the size of the
counts for accurate size factor estimation. Pool-based size factors are
then “deconvolved” into cell-based factors for normalization of each
cell’s expression profile.</p>
<pre class="r"><code># Normalization by deconvolution
clust.filtered &lt;- quickCluster(sce.filtered, BPPARAM =bpp)

sce.deconv &lt;- computeSumFactors(sce.filtered,clusters=clust.filtered, min.mean = 0.1, BPPARAM =bpp)

ggplot(data.frame(&quot;log10libSf&quot;=log10(sizeFactors(sce.deconv))), aes(x=log10libSf)) +
  xlab(&quot;Log10 Library size factor&quot;) +
  geom_histogram(bins=50)+
  ggtitle(&quot;Distribution of Deconvolution size factors&quot;)+
  theme_bw()+
  theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank())</code></pre>
<p><img src="figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-DeconvolutionNorm-1">
Past versions of DeconvolutionNorm-1.png
</button>
</p>
<div id="fig-DeconvolutionNorm-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/299e5e46be9c85e7a67149b098d473ca3e97a6b2/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">299e5e4</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/DeconvolutionNorm-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>print(&quot;Library size factors&quot;)</code></pre>
<pre><code>[1] &quot;Library size factors&quot;</code></pre>
<pre class="r"><code>summary(sizeFactors(sce.lib))</code></pre>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
0.02769 0.43277 0.77980 1.00000 1.33825 6.53892 </code></pre>
<pre class="r"><code>print(&quot;Deconvolution size factors&quot;)</code></pre>
<pre><code>[1] &quot;Deconvolution size factors&quot;</code></pre>
<pre class="r"><code>summary(sizeFactors(sce.deconv))</code></pre>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.000314 0.435267 0.788591 1.000000 1.328917 9.033548 </code></pre>
<div id="plot-deconvolution-against-dibrary-size-factors"
class="section level4 tabset">
<h4 class="tabset">Plot Deconvolution against Dibrary Size Factors</h4>
<p>Deconvolution size factor for each cell in the dataset, compared to
the equivalent size factor derived from the library size. The red line
corresponds to identity between the two size factors. Check that the
estimated library sizes are not too far from the library size factors,
estimated from the total number of counts.</p>
<div id="color-by-individual-cluster" class="section level5">
<h5>Color by Individual Cluster</h5>
<pre class="r"><code>#Color by individual cluster

 data.frame(LibrarySizeFactors = unname(sizeFactors(sce.lib)), DeconvolutionSizeFactors = sizeFactors(sce.deconv),Cluster = as.integer(clust.filtered)) %&gt;%
     ggplot(aes(x=LibrarySizeFactors, y=DeconvolutionSizeFactors)) +
     geom_point(aes(col=factor(Cluster))) +
     geom_abline(slope = 1, intercept = 0) + theme_classic() + theme(legend.key.size = unit(0.5, &#39;cm&#39;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotSizeFactors1-1">
Past versions of PlotSizeFactors1-1.png
</button>
</p>
<div id="fig-PlotSizeFactors1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotSizeFactors1-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="color-by-sample" class="section level5">
<h5>Color by Sample</h5>
<pre class="r"><code>#Color by sample
data.frame(LibrarySizeFactors = unname(sizeFactors(sce.lib)), DeconvolutionSizeFactors = sizeFactors(sce.deconv),Sample = sce.filtered$Sample) %&gt;%
     ggplot(aes(x=LibrarySizeFactors, y=DeconvolutionSizeFactors)) +
     geom_point(aes(col=Sample)) +
     geom_abline(slope = 1, intercept = 0) + theme_classic() + theme(legend.key.size = unit(0.5, &#39;cm&#39;))</code></pre>
<p><img src="figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-PlotSizeFactors2-1">
Past versions of PlotSizeFactors2-1.png
</button>
</p>
<div id="fig-PlotSizeFactors2-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/PlotSizeFactors2-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="apply-normalization" class="section level3">
<h3>Apply Normalization</h3>
<p>Apply the chosen normalization method</p>
<pre class="r"><code># Apply Normalisation
sce.filtered &lt;- logNormCounts(sce.deconv)
summary(sizeFactors(sce.filtered))</code></pre>
<pre><code>    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.000314 0.435267 0.788591 1.000000 1.328917 9.033548 </code></pre>
<pre class="r"><code>assayNames(sce.filtered)</code></pre>
<pre><code>[1] &quot;counts&quot;    &quot;logcounts&quot;</code></pre>
<pre class="r"><code>rm(sce.lib, sce.deconv)
gc()</code></pre>
<pre><code>            used   (Mb) gc trigger    (Mb) limit (Mb)   max used    (Mb)
Ncells  10396212  555.3   16904908   902.9         NA   16904908   902.9
Vcells 977780659 7459.9 2416800420 18438.8     102400 2414985991 18424.9</code></pre>
</div>
</div>
<div id="variable-level-metrics" class="section level2">
<h2>Variable-Level Metrics</h2>
<p>Variable-level metrics are computed by the getVarianceExplained()
function. This calculates the percentage of variance of each gene’s
expression that is explained by each variable in the colData of the
SingleCellExperiment object. We can then use this to determine which
experimental factors are contributing most to the variance in
expression. This is useful for diagnosing batch effects or to quickly
verify that a treatment has an effect.</p>
<pre class="r"><code>vars &lt;- getVarianceExplained(sce.filtered,assay.type=&quot;logcounts&quot;,
    variables=c(&quot;Sample&quot;, &quot;Joint.Location&quot;, &quot;Pathotype&quot;,&quot;Seropositivity&quot;,&quot;GCTreatment&quot;,&quot;Protocol&quot;,&quot;Sex&quot;,&quot;Age&quot;))
data.frame(head(vars))</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Sample"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Joint.Location"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pathotype"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Seropositivity"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["GCTreatment"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Protocol"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Sex"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Age"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.28531824","2":"0.008273722","3":"0.013864603","4":"0.0002375407","5":"0.0021337379","6":"1.655824e-03","7":"2.987896e-02","8":"9.502090e-04","_rn_":"ENSG00000238009.AL627309.1"},{"1":"0.04835705","2":"0.004429095","3":"0.005332618","4":"0.0083599194","5":"0.0027775647","6":"3.749146e-03","7":"8.979460e-05","8":"2.547409e-03","_rn_":"ENSG00000239945.AL627309.3"},{"1":"0.55802727","2":"0.024281498","3":"0.057538421","4":"0.0170683958","5":"0.0191076860","6":"8.976833e-03","7":"4.684571e-02","8":"2.019733e-02","_rn_":"ENSG00000241860.AL627309.5"},{"1":"0.10614373","2":"0.014543130","3":"0.034584312","4":"0.0029559309","5":"0.0064576726","6":"3.493613e-06","7":"1.943679e-03","8":"1.336439e-03","_rn_":"ENSG00000241599.AL627309.4"},{"1":"0.01411749","2":"0.005658877","3":"0.003219557","4":"0.0020090241","5":"0.0003277718","6":"2.070079e-07","7":"2.126688e-05","8":"5.633185e-05","_rn_":"ENSG00000229905.AL669831.2"},{"1":"0.95505243","2":"0.099836628","3":"0.242490393","4":"0.0448939319","5":"0.3298486520","6":"4.830356e-02","7":"1.082141e-02","8":"2.782515e-01","_rn_":"ENSG00000237491.LINC01409"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>plotExplanatoryVariables(vars)</code></pre>
<p><img src="figure/01_QualityControl.Rmd/VariableMetrics-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-VariableMetrics-1">
Past versions of VariableMetrics-1.png
</button>
</p>
<div id="fig-VariableMetrics-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/e3ca53ccc86eb864a5c6696758e6c9b4f08bc31a/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">e3ca53c</a>
</td>
<td>
sarloet
</td>
<td>
2024-06-01
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/4b8dd48c4471f612e317d4ea6cf4c4598cdfb3d2/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">4b8dd48</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/fe7615be921b2ffce1260e05c6199ce0ea255674/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">fe7615b</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-28
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/6cbb67d14c9a6e42894825d5ea9a50802728c67c/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">6cbb67d</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-24
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/906ed8cca35b490674aba343f419314d06637324/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">906ed8c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-23
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/ed4a9caf149bb230a93515926649150ab4ffc913/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">ed4a9ca</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-21
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/db195126af9bc8ebc4aff104c2c0fd9abb278b36/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">db19512</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-17
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/69f37f025d6e7370ff044dfeb8d9a0122c30e1bb/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">69f37f0</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-14
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/14ca55cb84c60cf353776c22d595167915b30d9b/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">14ca55c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-13
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/b04fd2c01a477c45c6c67e5fdadf37f5dc70ec65/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">b04fd2c</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/54eba19ca22ae30412346f7ca51364a06d50bec3/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">54eba19</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
<tr>
<td>
<a href="https://github.com/sarloet/RA_SingleCellAnalysis/blob/d18442a6f6c6116691d7ae46aef534746d95bdc1/docs/figure/01_QualityControl.Rmd/VariableMetrics-1.png" target="_blank">d18442a</a>
</td>
<td>
sarloet
</td>
<td>
2024-05-06
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="save-dataset" class="section level2">
<h2>Save Dataset</h2>
<pre class="r"><code>dim(sce.filtered)</code></pre>
<pre><code>[1] 30488 64639</code></pre>
<pre class="r"><code>saveRDS(sce.filtered, file =paste0(path,&#39;/output/01_sce_QualityControl.rds&#39;))</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.3.3 (2024-02-29)
Platform: x86_64-apple-darwin20 (64-bit)
Running under: macOS Sonoma 14.4.1

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-x86_64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Warsaw
tzcode source: internal

attached base packages:
[1] grid      stats4    stats     graphics  grDevices datasets  utils    
[8] methods   base     

other attached packages:
 [1] tidyr_1.3.1                 org.Hs.eg.db_3.18.0        
 [3] AnnotationDbi_1.64.1        clusterProfiler_4.10.1     
 [5] viridis_0.6.5               viridisLite_0.4.2          
 [7] gridExtra_2.3               scran_1.30.2               
 [9] scater_1.30.1               scuttle_1.12.0             
[11] SingleCellExperiment_1.24.0 SummarizedExperiment_1.32.0
[13] Biobase_2.62.0              GenomicRanges_1.54.1       
[15] GenomeInfoDb_1.38.8         IRanges_2.36.0             
[17] S4Vectors_0.40.2            BiocGenerics_0.48.1        
[19] MatrixGenerics_1.14.0       matrixStats_1.3.0          
[21] dplyr_1.1.4                 ggplot2_3.5.1              
[23] BiocParallel_1.36.0         here_1.0.1                 
[25] workflowr_1.7.1            

loaded via a namespace (and not attached):
  [1] splines_4.3.3             later_1.3.2              
  [3] bitops_1.0-7              ggplotify_0.1.2          
  [5] tibble_3.2.1              polyclip_1.10-6          
  [7] lifecycle_1.0.4           edgeR_4.0.16             
  [9] rprojroot_2.0.4           processx_3.8.4           
 [11] lattice_0.22-5            MASS_7.3-60.0.1          
 [13] magrittr_2.0.3            limma_3.58.1             
 [15] sass_0.4.9                rmarkdown_2.27           
 [17] jquerylib_0.1.4           yaml_2.3.8               
 [19] metapod_1.10.1            httpuv_1.6.15            
 [21] cowplot_1.1.3             DBI_1.2.2                
 [23] RColorBrewer_1.1-3        abind_1.4-5              
 [25] zlibbioc_1.48.2           purrr_1.0.2              
 [27] ggraph_2.2.1              RCurl_1.98-1.14          
 [29] yulab.utils_0.1.4         tweenr_2.0.3             
 [31] git2r_0.33.0              GenomeInfoDbData_1.2.11  
 [33] enrichplot_1.22.0         ggrepel_0.9.5            
 [35] irlba_2.3.5.1             tidytree_0.4.6           
 [37] dqrng_0.4.0               DelayedMatrixStats_1.24.0
 [39] codetools_0.2-19          DelayedArray_0.28.0      
 [41] DOSE_3.28.2               ggforce_0.4.2            
 [43] tidyselect_1.2.1          aplot_0.2.2              
 [45] farver_2.1.2              ScaledMatrix_1.10.0      
 [47] jsonlite_1.8.8            BiocNeighbors_1.20.2     
 [49] tidygraph_1.3.1           tools_4.3.3              
 [51] treeio_1.26.0             Rcpp_1.0.12              
 [53] glue_1.7.0                SparseArray_1.2.4        
 [55] xfun_0.44                 qvalue_2.34.0            
 [57] withr_3.0.0               BiocManager_1.30.23      
 [59] fastmap_1.2.0             bluster_1.12.0           
 [61] fansi_1.0.6               callr_3.7.6              
 [63] digest_0.6.35             rsvd_1.0.5               
 [65] R6_2.5.1                  gridGraphics_0.5-1       
 [67] colorspace_2.1-0          GO.db_3.18.0             
 [69] RSQLite_2.3.6             utf8_1.2.4               
 [71] generics_0.1.3            renv_1.0.7               
 [73] data.table_1.15.4         graphlayouts_1.1.1       
 [75] httr_1.4.7                S4Arrays_1.2.1           
 [77] scatterpie_0.2.2          whisker_0.4.1            
 [79] pkgconfig_2.0.3           gtable_0.3.5             
 [81] blob_1.2.4                XVector_0.42.0           
 [83] shadowtext_0.1.3          htmltools_0.5.8.1        
 [85] fgsea_1.28.0              scales_1.3.0             
 [87] png_0.1-8                 ggfun_0.1.4              
 [89] knitr_1.45                rstudioapi_0.16.0        
 [91] reshape2_1.4.4            nlme_3.1-164             
 [93] cachem_1.1.0              stringr_1.5.1            
 [95] parallel_4.3.3            vipor_0.4.7              
 [97] HDO.db_0.99.1             pillar_1.9.0             
 [99] vctrs_0.6.5               promises_1.3.0           
[101] BiocSingular_1.18.0       beachmat_2.18.1          
[103] cluster_2.1.6             beeswarm_0.4.0           
[105] evaluate_0.23             cli_3.6.2                
[107] locfit_1.5-9.9            compiler_4.3.3           
[109] rlang_1.1.3               crayon_1.5.2             
[111] labeling_0.4.3            ps_1.7.6                 
[113] getPass_0.2-4             plyr_1.8.9               
[115] fs_1.6.4                  ggbeeswarm_0.7.2         
[117] stringi_1.8.4             munsell_0.5.1            
[119] Biostrings_2.70.3         lazyeval_0.2.2           
[121] GOSemSim_2.28.1           Matrix_1.6-5             
[123] patchwork_1.2.0           sparseMatrixStats_1.14.0 
[125] bit64_4.0.5               KEGGREST_1.42.0          
[127] statmod_1.5.0             highr_0.10               
[129] igraph_2.0.3              memoise_2.0.1            
[131] bslib_0.7.0               ggtree_3.10.1            
[133] fastmatch_1.1-4           bit_4.0.5                
[135] gson_0.1.0                ape_5.8                  </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
